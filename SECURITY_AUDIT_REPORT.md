# –û–¢–ß–ï–¢ –ê–£–î–ò–¢–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
## –ü—Ä–æ–µ–∫—Ç: Tel Call - –°–µ—Ä–≤–∏—Å –∞—É–¥–∏–æ/–≤–∏–¥–µ–æ-–∑–≤–æ–Ω–∫–æ–≤ —á–µ—Ä–µ–∑ Telegram

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç–∞:** 2026-01-08
**–ê—É–¥–∏—Ç–æ—Ä:** Claude (Security Audit Agent)
**–í–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞:** —Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è –Ω–∞ –≤–µ—Ç–∫–µ `claude/security-audit-67mAg`

---

## EXECUTIVE SUMMARY

–ü—Ä–æ–≤–µ–¥–µ–Ω –ø–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ Tel Call –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏—á–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º. –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –∞—É–¥–∏–æ/–≤–∏–¥–µ–æ –∑–≤–æ–Ω–∫–æ–≤, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å Telegram Mini App, –∏—Å–ø–æ–ª—å–∑—É—é—â—É—é WebRTC –¥–ª—è —Å–≤—è–∑–∏.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- Backend: Python 3.11 + FastAPI + SQLAlchemy + PostgreSQL
- Frontend: React 18 + TypeScript + Vite
- Infrastructure: Docker + Traefik + TURN/STUN
- Integration: Telegram Bot API + Telegram Mini Apps

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞—É–¥–∏—Ç–∞:**
- üî¥ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏:** 3
- üü† **–í—ã—Å–æ–∫–∞—è –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** 6
- üü° **–°—Ä–µ–¥–Ω—è—è –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** 8
- üü¢ **–ù–∏–∑–∫–∞—è –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** 5

**–û–ë–©–ê–Ø –û–¶–ï–ù–ö–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò: 6.5/10**

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò (CRITICAL)

### 1. Traefik API Dashboard –æ—Ç–∫—Ä—ã—Ç –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (CVSS 8.2)

**–§–∞–π–ª:** `infra/docker-compose.yml:27-28`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```yaml
--api.dashboard=true
--api.insecure=true  # ‚ö†Ô∏è –û–ü–ê–°–ù–û!
```

**–†–∏—Å–∫–∏:**
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- Information disclosure –æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û—Ç–∫–ª—é—á–∏—Ç—å `--api.insecure=true` –≤ production –∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å BasicAuth.

---

### 2. Rate Limiting –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints (CVSS 7.5)

**–§–∞–π–ª:** `backend/app/api/auth.py:102`, `backend/app/api/calls.py:75-76`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `/auth/telegram` - rate limit `5/minute` (—Å–ª–∏—à–∫–æ–º –º—è–≥–∫–∏–π)
- `/api/calls` - rate limit `10/minute` (—Å–ª–∏—à–∫–æ–º –º—è–≥–∫–∏–π)

**–†–∏—Å–∫–∏:**
- DoS –∞—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- Exhaustion —Ä–µ—Å—É—Ä—Å–æ–≤ —Å–µ—Ä–≤–µ—Ä–∞
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–±–æ—Ä–∞ —Ç–æ–∫–µ–Ω–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```python
@limiter.limit("3/minute")  # –£–º–µ–Ω—å—à–∏—Ç—å —Å 5 –¥–æ 3
@limiter.limit("20/hour")   # –î–æ–±–∞–≤–∏—Ç—å hourly limit
```

---

### 3. JWT —Ç–æ–∫–µ–Ω—ã –∏–º–µ—é—Ç –æ—á–µ–Ω—å –¥–æ–ª–≥–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ (CVSS 6.8)

**–§–∞–π–ª:** `backend/.env.example:15`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
ACCESS_TOKEN_EXPIRE_MINUTES=43200  # 30 –¥–Ω–µ–π!
```

**–†–∏—Å–∫–∏:**
- –£–∫—Ä–∞–¥–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω –¥–µ–π—Å—Ç–≤—É–µ—Ç 30 –¥–Ω–µ–π
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–æ–∑–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø
- –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–º–µ–Ω—å—à–∏—Ç—å –¥–æ 60 –º–∏–Ω—É—Ç –∏ –≤–Ω–µ–¥—Ä–∏—Ç—å refresh token –º–µ—Ö–∞–Ω–∏–∑–º.

---

## üü† –í–´–°–û–ö–ê–Ø –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨ (HIGH)

### 4. CORS configured to allow all origins by default (CVSS 7.1)

**–§–∞–π–ª:** `backend/app/main.py:74`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
allowed_origins = settings.allowed_origins or ["*"]  # –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ!
```

**–†–∏—Å–∫–∏:** CSRF –∞—Ç–∞–∫–∏ –≤–æ–∑–º–æ–∂–Ω—ã —Å –ª—é–±–æ–≥–æ –¥–æ–º–µ–Ω–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–µ —Ä–∞–∑—Ä–µ—à–∞—Ç—å wildcard –≤ production - —Ç—Ä–µ–±–æ–≤–∞—Ç—å —è–≤–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É CORS_ALLOW_ORIGINS.

---

### 5. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –≤ inline query (CVSS 6.2)

**–§–∞–π–ª:** `backend/app/api/telegram_webhook.py:64-93`

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å invite –¥–ª—è –ª—é–±–æ–≥–æ –∑–≤–æ–Ω–∫–∞, –∑–Ω–∞—è —Ç–æ–ª—å–∫–æ `call_id`.

**–†–∏—Å–∫–∏:**
- –ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∑–≤–æ–Ω–∫–∞–º
- Information disclosure

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —è–≤–ª—è–µ—Ç—Å—è creator –∏–ª–∏ participant –∑–≤–æ–Ω–∫–∞ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º inline query result.

---

### 6. WebSocket –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç Origin header (CVSS 6.5)

**–§–∞–π–ª:** `backend/app/api/signaling.py:228-483`

**–ü—Ä–æ–±–ª–µ–º–∞:** WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç Origin header.

**–†–∏—Å–∫–∏:** CSRF –∞—Ç–∞–∫–∏ —á–µ—Ä–µ–∑ WebSocket

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```python
origin = websocket.headers.get("origin")
if origin and origin not in settings.allowed_origins:
    await websocket.close(code=4403, reason="Invalid origin")
```

---

### 7. Bot handlers –æ–±–Ω–æ–≤–ª—è—é—Ç username –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (CVSS 5.8)

**–§–∞–π–ª:** `backend/app/services/bot_handlers.py:61`

**–ü—Ä–æ–±–ª–µ–º–∞:** Username –æ—Ç Telegram –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –±–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–µ—Å—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ auth.py, –Ω–æ –Ω–µ –≤ bot_handlers.py).

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—É –∂–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é `_is_username_valid` –∏–∑ auth.py.

---

### 8. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∑–∞—â–∏—Ç–∞ –æ—Ç WebSocket message flood (CVSS 6.5)

**–§–∞–π–ª:** `backend/app/api/signaling.py:57-91`

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–∞–∑–º–µ—Ä WebSocket —Å–æ–æ–±—â–µ–Ω–∏–π –æ–≥—Ä–∞–Ω–∏—á–µ–Ω 1MB, –Ω–æ –Ω–µ—Ç rate limiting –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è WebSocket —Å–æ–æ–±—â–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 100 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –º–∏–Ω—É—Ç—É).

---

### 9. Docker socket –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω (CVSS 9.0)

**–§–∞–π–ª:** `infra/docker-compose.yml:47`

**–ü—Ä–æ–±–ª–µ–º–∞:** Docker socket –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –≤ Traefik –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Docker socket proxy –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞.

---

## üü° –°–†–ï–î–ù–Ø–Ø –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨ (MEDIUM)

### 10. Email –∞–¥—Ä–µ—Å –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Let's Encrypt (CVSS 3.1)

**–§–∞–π–ª:** `infra/docker-compose.yml:37`

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–∏—á–Ω—ã–π email –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—ã–Ω–µ—Å—Ç–∏ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `ACME_EMAIL`.

---

### 11. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç Content Security Policy (CVSS 5.5)

**–§–∞–π–ª:** Backend headers

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã CSP –∑–∞–≥–æ–ª–æ–≤–∫–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å middleware –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ security headers (CSP, X-Frame-Options, X-Content-Type-Options).

---

### 12. Friend links —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (CVSS 4.8)

**–§–∞–π–ª:** `backend/app/api/signaling.py:311-330`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ –∑–≤–æ–Ω–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è friend links.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å opt-in –º–µ—Ö–∞–Ω–∏–∑–º –∏–ª–∏ friend request —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª.

---

### 13. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ security —Å–æ–±—ã—Ç–∏–π (CVSS 5.0)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å structured logging –¥–ª—è security-–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π.

---

### 14. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –∑–≤–æ–Ω–∫–æ–≤ (CVSS 4.3)

**–§–∞–π–ª:** `backend/app/api/calls.py:74-148`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∑–≤–æ–Ω–∫–æ–≤.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞ —Å —Ç–∞–∫–∏–º –∂–µ title –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –º–∏–Ω—É—Ç.

---

### 15. Participants —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ –∏–º–µ–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ (CVSS 4.2)

**–§–∞–π–ª:** `backend/app/models/participant.py`

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –Ω–∞ (call_id, user_id).

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.

---

### 16. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–≤–æ–Ω–∫–∞ (CVSS 4.5)

**–§–∞–π–ª:** `backend/app/api/calls.py:200-249`

**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–æ–ª—å–∫–æ creator –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–≤–æ–Ω–æ–∫.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª report/leave –¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.

---

### 17. Secure flag –¥–ª—è cookies —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤ dev (CVSS 4.0)

**–§–∞–π–ª:** `backend/app/api/auth.py:129`

**–ü—Ä–æ–±–ª–µ–º–∞:** Cookies –≤—Å–µ–≥–¥–∞ –∏–º–µ—é—Ç `secure=True`, —á—Ç–æ –º–æ–∂–µ—Ç –ª–æ–º–∞—Ç—å—Å—è –≤ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `secure=not settings.debug`.

---

## üü¢ –ù–ò–ó–ö–ê–Ø –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨ (LOW)

### 18. –ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è call_id (CVSS 2.0)

**–§–∞–π–ª:** `backend/app/models/call.py:21-28`

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–æ–≥–∏–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–±—ã—Ç–æ—á–Ω–∞.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–ø—Ä–æ—Å—Ç–∏—Ç—å –¥–æ `return secrets.token_urlsafe(15)`.

---

### 19. Hardcoded timeout –∑–Ω–∞—á–µ–Ω–∏—è (CVSS 2.5)

**–§–∞–π–ª:** `backend/app/services/telegram_bot.py:26`

**–ü—Ä–æ–±–ª–µ–º–∞:** Timeout –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—ã–Ω–µ—Å—Ç–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

---

### 20. Healthcheck –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (CVSS 3.0)

**–§–∞–π–ª:** `backend/app/api/health.py`

**–ü—Ä–æ–±–ª–µ–º–∞:** Healthcheck –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ë–î –∏ –¥—Ä—É–≥–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

---

### 21. Frontend API_BASE_URL –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω (CVSS 2.8)

**–§–∞–π–ª:** `frontend/src/services/apiClient.ts:14-18`

**–ü—Ä–æ–±–ª–µ–º–∞:** URL –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω —á–µ—Ä–µ–∑ env (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫ –≤ production).

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é URL.

---

### 22. –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç graceful shutdown –¥–ª—è WebSocket (CVSS 2.2)

**–§–∞–π–ª:** `backend/app/main.py:29-63`

**–ü—Ä–æ–±–ª–µ–º–∞:** WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –æ–±—Ä—ã–≤–∞—é—Ç—Å—è —Ä–µ–∑–∫–æ –ø—Ä–∏ shutdown.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–µ—Ä–µ–¥ shutdown.

---

## üìã –•–û–†–û–®–ò–ï –ü–†–ê–ö–¢–ò–ö–ò –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–´–ï ‚úÖ

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ httpOnly cookies –¥–ª—è JWT
2. –í–∞–ª–∏–¥–∞—Ü–∏—è Telegram initData —á–µ—Ä–µ–∑ HMAC
3. SQLAlchemy ORM –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç SQL injection
4. Rate limiting –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö endpoints
5. Structured logging –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
6. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Pydantic –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
7. Async/await –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
8. Health check endpoint
9. CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Ç—Ä–µ–±—É—é—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏)
10. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ secrets.token_urlsafe –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ID

---

## üìä –ü–†–ò–û–†–ò–¢–ò–ó–ê–¶–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### ‚ö†Ô∏è –ù–ï–ú–ï–î–õ–ï–ù–ù–û (24 —á–∞—Å–∞):

1. –û—Ç–∫–ª—é—á–∏—Ç—å `--api.insecure=true` –≤ Traefik
2. –£–±—Ä–∞—Ç—å wildcard CORS –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å strict validation
3. –£–º–µ–Ω—å—à–∏—Ç—å –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ JWT —Ç–æ–∫–µ–Ω–æ–≤ –¥–æ 60 –º–∏–Ω—É—Ç

### üìÖ –í –¢–ï–ß–ï–ù–ò–ï –ù–ï–î–ï–õ–ò:

4. –£—Å–∏–ª–∏—Ç—å rate limiting –Ω–∞ –≤—Å–µ—Ö endpoints
5. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é origin –¥–ª—è WebSocket
6. –ò—Å–ø—Ä–∞–≤–∏—Ç—å inline query authorization
7. –î–æ–±–∞–≤–∏—Ç—å CSP headers
8. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å security logging

### üìÜ –í –¢–ï–ß–ï–ù–ò–ï –ú–ï–°–Ø–¶–ê:

9. –í–Ω–µ–¥—Ä–∏—Ç—å refresh token –º–µ—Ö–∞–Ω–∏–∑–º
10. –î–æ–±–∞–≤–∏—Ç—å opt-in –¥–ª—è friend links
11. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ alerting
12. –ü—Ä–æ–≤–µ—Å—Ç–∏ penetration testing
13. –î–æ–±–∞–≤–∏—Ç—å graceful shutdown

---

## üîç –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ò–ù–§–†–ê–°–¢–†–£–ö–¢–£–†–ï

### Secrets Management:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Docker secrets
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å HashiCorp Vault –∏–ª–∏ AWS Secrets Manager
- –†–æ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ —Ä–∞–∑ –≤ 90 –¥–Ω–µ–π

### Monitoring & Alerting:
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Prometheus + Grafana
- –ê–ª–µ—Ä—Ç—ã –Ω–∞ –∞–Ω–æ–º–∞–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (ELK/Loki)

### Backup & Recovery:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã PostgreSQL
- Disaster recovery plan
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### Network Security:
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å firewall –ø—Ä–∞–≤–∏–ª–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å VPC/private networks
- –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ PostgreSQL
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å fail2ban

### SSL/TLS:
- –¢–æ–ª—å–∫–æ TLS 1.2+
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å HSTS headers
- –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

---

## üõ°Ô∏è –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ü–†–û–¶–ï–°–°–ê–ú

### Security Scanning:
- SAST (bandit, semgrep) –≤ CI/CD
- Dependency scanning (dependabot, snyk)
- Container scanning (trivy, clair)

### Code Review:
- Mandatory review –¥–ª—è security-–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- Security checklist –¥–ª—è reviewers

### Testing:
- Unit tests –¥–ª—è auth logic
- Integration tests –¥–ª—è API
- Security tests (OWASP ZAP)
- Load testing –¥–ª—è WebRTC

---

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–ü—Ä–æ–µ–∫—Ç Tel Call –∏–º–µ–µ—Ç **—Ö–æ—Ä–æ—à—É—é –±–∞–∑–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç **—Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π** –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏—á–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º.

**–û—Å–Ω–æ–≤–Ω—ã–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è Telegram –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ httpOnly cookies
- Async –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (Traefik dashboard)
- –°–ª–∞–±—ã–π rate limiting
- –î–æ–ª–≥–æ–µ –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–æ–≤ (30 –¥–Ω–µ–π)
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö security headers

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** 6.5/10

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** ‚ö†Ô∏è –ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ CRITICAL –∏ HIGH —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏—á–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º.

---

**–ù–∞–π–¥–µ–Ω–æ –ø—Ä–æ–±–ª–µ–º:**
- üî¥ CRITICAL: 3
- üü† HIGH: 6
- üü° MEDIUM: 8
- üü¢ LOW: 5

**–ò—Ç–æ–≥–æ:** 22 –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

*–ö–æ–Ω–µ—Ü –æ—Ç—á–µ—Ç–∞. –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª–µ–Ω –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.*

